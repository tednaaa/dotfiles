#!/usr/bin/fish

if test (id -u) -eq 0
	echo "This script should not be run as root"
	exit 1
end

set dotfiles_repository "https://github.com/tednaaa/dotfiles"


sudo pacman -Syu --noconfirm


if not command -s rustup
	curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
end
if not command -s mise
	curl https://mise.run | sh
end
if not command -s paru
	sudo pacman -S --noconfirm --needed base-devel git
	git clone https://aur.archlinux.org/paru.git
	cd paru
	makepkg -si --noconfirm --needed
end

if not test -d ~/dotfiles
	git clone $dotfiles_repository ~/dotfiles
end

paru -S --noconfirm --needed symm
symm unlink
symm link
symm packages install --noconfirm


systemctl enable docker.socket
sudo usermod -aG docker $USER

rfkill unblock bluetooth
systemctl enable bluetooth
